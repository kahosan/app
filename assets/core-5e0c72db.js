import{j as e}from"./index-021ad583.js";import{E as v,m as u,U as E,j as K,u as M,M as B,P as q,i as F,F as $}from"./messenger-provider-a886fcd3.js";import{c as g}from"./classnames-7ca44501.js";import{R as L}from"./Resizable-0f45651c.js";import"./copyToClipboard-445aa5b6.js";const z="ppd-bottom-status";function I(){const{plugins:n,...i}=React.useContext(v),p=React.useMemo(()=>n.filter(o=>{var c;return(c=o.editor)==null?void 0:c.statusbar}).flatMap(o=>{var c;return((c=o.editor)==null?void 0:c.statusbar)??[]}),[n]);return e.jsx("div",{className:`monaco-editor ${z}`,children:p.map((o,c)=>e.jsx(o,{...i},c))})}const T="/app/assets/PP_P-929f1e81.svg",j="ppd-left-bar";function D(n){return e.jsxs("div",{className:g(j,n.className),style:n.style,children:[e.jsxs("div",{className:`${j}__top`,children:[e.jsx("button",{onClick:()=>u.then(i=>i.display("warning",e.jsxs(e.Fragment,{children:["Not implemented yet, it will come soon, ",e.jsx("a",{href:"https://github.com/Power-Playground/app/issues?q=is%3Aissue+is%3Aopen+label%3A%22help+wanted%22",target:"_blank",rel:"noreferrer",children:"help us"})]}))),children:e.jsx("span",{className:"cldr codicon codicon-folder"})}),e.jsx("button",{onClick:()=>u.then(i=>i.display("warning",e.jsxs(e.Fragment,{children:["Not implemented yet, it will come soon, ",e.jsx("a",{href:"https://github.com/Power-Playground/app/issues?q=is%3Aissue+is%3Aopen+label%3A%22help+wanted%22",target:"_blank",rel:"noreferrer",children:"help us"})]}))),children:e.jsx("span",{className:"cldr codicon codicon-heart"})}),e.jsx("button",{onClick:()=>u.then(i=>i.display("warning",e.jsxs(e.Fragment,{children:["Not implemented yet, it will come soon, ",e.jsx("a",{href:"https://github.com/Power-Playground/app/issues?q=is%3Aissue+is%3Aopen+label%3A%22help+wanted%22",target:"_blank",rel:"noreferrer",children:"help us"})]}))),children:e.jsx("span",{className:"cldr codicon codicon-source-control"})}),e.jsx("button",{onClick:()=>u.then(i=>i.display("warning",e.jsxs(e.Fragment,{children:["Not implemented yet, it will come soon, ",e.jsx("a",{href:"https://github.com/Power-Playground/app/issues?q=is%3Aissue+is%3Aopen+label%3A%22help+wanted%22",target:"_blank",rel:"noreferrer",children:"help us"})]}))),children:e.jsx("span",{className:"cldr codicon codicon-book"})}),e.jsx("button",{onClick:()=>u.then(i=>i.display("warning",e.jsxs(e.Fragment,{children:["Not implemented yet, it will come soon, ",e.jsx("a",{href:"https://github.com/Power-Playground/app/issues?q=is%3Aissue+is%3Aopen+label%3A%22help+wanted%22",target:"_blank",rel:"noreferrer",children:"help us"})]}))),children:e.jsx("span",{className:"cldr codicon codicon-extensions"})})]}),e.jsxs("div",{className:`${j}__bottom`,children:[e.jsx("button",{onClick:()=>u.then(i=>i.display("warning",e.jsxs(e.Fragment,{children:["Not implemented yet, it will come soon, ",e.jsx("a",{href:"https://github.com/Power-Playground/app/issues?q=is%3Aissue+is%3Aopen+label%3A%22help+wanted%22",target:"_blank",rel:"noreferrer",children:"help us"})]}))),children:e.jsx("span",{className:"cldr codicon codicon-account"})}),e.jsx("button",{onClick:()=>u.then(i=>i.display("warning",e.jsxs(e.Fragment,{children:["Not implemented yet, it will come soon, ",e.jsx("a",{href:"https://github.com/Power-Playground/app/issues?q=is%3Aissue+is%3Aopen+label%3A%22help+wanted%22",target:"_blank",rel:"noreferrer",children:"help us"})]}))),children:e.jsx("span",{className:"cldr codicon codicon-gear"})}),e.jsx("img",{src:T,alt:"Power Playground menu icon."})]})]})}const H="ppd-top-bar";function U({className:n}){const{plugins:i,...p}=React.useContext(v),o=React.useMemo(()=>i.filter(c=>{var l;return(l=c.editor)==null?void 0:l.topbar}).flatMap(c=>{var l;return((l=c.editor)==null?void 0:l.topbar)??[]}),[i]);return e.jsx("div",{className:g(H,n),children:o.map((c,l)=>e.jsx(c,{...p},l))})}const w="ppd-editor-zone";function J(n){const{enableMenuSwitch:i=!0}=n,p=React.useRef(new URLSearchParams(location.search)),[o,c]=React.useState(null),l=React.useMemo(()=>Object.values(n.plugins??{}).filter(s=>!!s),[n.plugins]),f=l.reduce((s,t)=>{var r,d;return{...s,...(d=(r=t.editor)==null?void 0:r.use)==null?void 0:d.reduce((x,h)=>({...x,...h==null?void 0:h({searchParams:p.current,editor:o})}),{})}},{}),{code:P,setCode:y,loadingNode:C,curFilePath:S,language:k}=f;if(y===void 0)throw new Error("You must register a plugin to provide `setCode` function");const a=E();React.useEffect(()=>{if(!a)return;const s=l.map(t=>{var r,d;return(d=(r=t==null?void 0:t.editor)==null?void 0:r.preload)==null?void 0:d.call(r,a)});return()=>s.forEach(t=>t==null?void 0:t())},[a,l]),React.useEffect(()=>{if(!a||!o)return;const s=o;try{a.editor.addKeybindingRule({keybinding:a.KeyMod.CtrlCmd|a.KeyMod.Shift|a.KeyCode.KeyP,command:"editor.action.quickCommand"})}catch(t){console.error(t);const r=s._standaloneKeybindingService.getKeybindings(),d=r.findIndex(x=>x.command==="editor.action.quickCommand");d!==-1&&r.splice(d,1),s._standaloneKeybindingService.addDynamicKeybinding("editor.action.quickCommand",a.KeyMod.CtrlCmd|a.KeyMod.Shift|a.KeyCode.KeyP,()=>{o.trigger("whatever","editor.action.quickCommand",{})})}},[o,a]),l.forEach(s=>{var t,r;return(r=(t=s==null?void 0:s.editor)==null?void 0:t.useShare)==null?void 0:r.call(t,f,a)});const[N,A]=React.useState("light");React.useEffect(()=>onThemeChange(A),[]);const[m,R]=jotai.useAtom(K),_=React.useRef(null);return React.useEffect(()=>{if(o)return o.setPosition(_.current??{lineNumber:1,column:1}),o.focus(),()=>{_.current=o.getPosition()??null}},[k,o]),React.useEffect(()=>{if(!a||!o)return;const s=l.map(t=>{var d,x;const r=(x=(d=t==null?void 0:t.editor)==null?void 0:d.load)==null?void 0:x.call(d,o,a);if(typeof r=="function")return r;if(Array.isArray(r))return r.reduce((h,b)=>()=>(h==null||h(),b==null?void 0:b()),()=>{})});return()=>s.forEach(t=>t==null?void 0:t())},[a,o,l]),M("keydown",s=>{s.key==="\\"&&(s.metaKey||s.ctrlKey)&&R(!m)}),e.jsx(v.Provider,{value:{searchParams:p.current,plugins:l,shareState:f},children:e.jsx(B.Provider,{value:{monaco:a,editorInstance:o,store:{code:[P,y],theme:[N,A]}},children:e.jsxs(L,{className:g(w,n.className),style:{...n.style,"--border-width":"2px",width:"var(--editor-width, 50%)",minWidth:"var(--editor-min-width)",maxWidth:"var(--editor-max-width)",height:"var(--editor-height, 50%)",minHeight:"var(--editor-min-height)",maxHeight:"var(--editor-max-height)"},resizable:n.resizable??{right:!0},onBorderBtnClick:n.onBorderBtnClick,children:[i&&e.jsx(q,{placement:"right",className:g(`${w}__menu-switch`,{"is-active":m}),content:e.jsxs(e.Fragment,{children:[m?"Hide activity bar":"Show activity bar",e.jsx("br",{}),e.jsxs("kbd",{children:[F?"âŒ˜":"Ctrl"," + \\"]})]}),onClick:()=>R(!m),children:e.jsx("span",{className:g("cldr codicon",m?"codicon-menu":"codicon-layout-activitybar-left")})}),e.jsx(D,{style:{width:m?void 0:0,padding:m?void 0:0}}),e.jsxs("div",{className:`${w}__container`,children:[e.jsx(U,{className:i&&m?"is-active":void 0}),C??e.jsx($,{language:k,options:{automaticLayout:!0,scrollbar:{vertical:"hidden",verticalSliderSize:0,verticalScrollbarSize:0}},theme:N==="light"?"vs":"vs-dark",loading:C,path:`file://${S}`,value:P,onChange:s=>y(s??""),onMount:s=>(c(s),s.focus())}),e.jsx(I,{})]})]})})})}function Q(n){return n??{}}export{J as E,Q as d};
